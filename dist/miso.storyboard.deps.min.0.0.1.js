/**
* Miso.Storyboard - v0.0.1 - 3/22/2013
* http://github.com/misoproject/storyboard
* Copyright (c) 2013 Alex Graul, Irene Ros, Rich Harris;
* Dual Licensed: MIT, GPL
* https://github.com/misoproject/storyboard/blob/master/LICENSE-MIT 
* https://github.com/misoproject/storyboard/blob/master/LICENSE-GPL 
*/(function(n,t){function e(n){return n&&n.__wrapped__?n:this instanceof e?(this.__wrapped__=n,t):new e(n)}function r(n,t,e){t||(t=0);var r=n.length,i=r-t>=(e||ee),o=i?{}:n;if(i)for(var u=t-1;r>++u;){var s=n[u]+"";(xe.call(o,s)?o[s]:o[s]=[]).push(n[u])}return function(n){if(i){var e=n+"";return xe.call(o,e)&&at(o[e],n)>-1}return at(o,n,t)>-1}}function i(n,e){var r=n.index,i=e.index;if(n=n.criteria,e=e.criteria,n!==e){if(n>e||n===t)return 1;if(e>n||e===t)return-1}return i>r?-1:1}function o(n,t,e){function r(){var s=arguments,a=o?this:t;if(i||(n=t[u]),e.length&&(s=s.length?e.concat(ke.call(s)):e),this instanceof r){f.prototype=n.prototype,a=new f;var c=n.apply(a,s);return c&&nr[typeof c]?c:a}return n.apply(a,s)}var i=S(n),o=!e,u=n;return o&&(e=t),r}function u(n,e){return n?"function"!=typeof n?function(t){return t[n]}:e!==t?function(t,r,i){return n.call(e,t,r,i)}:n:Ft}function s(){for(var n,t={arrayLoop:"",bottom:"",hasDontEnumBug:Qt,isKeysFast:Xe,objectLoop:"",noArgsEnum:We,noCharByIndex:Ve,shadowed:_e,top:"",useHas:!0},e=0;n=arguments[e];e++)for(var r in n)t[r]=n[r];var i=t.args;t.firstArg=/^[^,]+/.exec(i)[0];var o=Function("createCallback, hasOwnProperty, isArguments, objectTypes, nativeKeys, propertyIsEnumerable, stringClass, toString","return function("+i+") {\n"+er(t)+"\n}");return o(u,xe,h,nr,Le,we,$e,Se)}function a(n){return"\\"+tr[n]}function c(n){return ar[n]}function f(){}function l(n){return cr[n]}function h(n){return Se.call(n)==Te}function p(n){var t=!1;if(!n||"object"!=typeof n||h(n))return t;var e=n.constructor;return Ge&&"function"!=typeof n.toString&&"string"==typeof(n+"")||S(e)&&!(e instanceof e)?t:Xt?(ur(n,function(n,e,r){return t=!xe.call(r,e),!1}),t===!1):(ur(n,function(n,e){t=e}),t===!1||xe.call(n,t))}function v(n){var t=[];return sr(n,function(n,e){t.push(e)}),t}function _(n,t,e,r,i){if(null==n)return n;e&&(t=!1);var o=nr[typeof n];if(o){var u=Se.call(n);if(!Ze[u]||Ue&&h(n))return n;var s=u==Fe;o=s||(u==Ne?pr(n):o)}if(!o||!t)return o?s?ke.call(n):lr({},n):n;var a=n.constructor;switch(u){case Pe:case Me:return new a(+n);case qe:case $e:return new a(n);case He:return a(n.source,ce.exec(n))}r||(r=[]),i||(i=[]);for(var c=r.length;c--;)if(r[c]==n)return i[c];var f=s?a(n.length):{};return r.push(n),i.push(f),(s?_r:sr)(n,function(n,e){f[e]=_(n,t,null,r,i)}),f}function g(n){var t=[];return ur(n,function(n,e){S(n)&&t.push(e)}),t.sort()}function d(n,t){return n?xe.call(n,t):!1}function y(n){var t={};return sr(n,function(n,e){t[n]=e}),t}function m(n){return n===!0||n===!1||Se.call(n)==Pe}function b(n){return Se.call(n)==Me}function x(n){return n?1===n.nodeType:!1}function j(n){var t=!0;if(!n)return t;var e=Se.call(n),r=n.length;return e==Fe||e==$e||e==Te||Ue&&h(n)||e==Ne&&"number"==typeof r&&S(n.splice)?!r:(sr(n,function(){return t=!1}),t)}function w(n,t,e,r){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;var i=Se.call(n);if(i!=Se.call(t))return!1;switch(i){case Pe:case Me:return+n==+t;case qe:return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case He:case $e:return n==t+""}var o=i==Fe||i==Te;if(Ue&&!o&&(o=h(n))&&!h(t))return!1;if(!o){if(n.__wrapped__||t.__wrapped__)return w(n.__wrapped__||n,t.__wrapped__||t);if(i!=Ne||Ge&&("function"!=typeof n.toString&&"string"==typeof(n+"")||"function"!=typeof t.toString&&"string"==typeof(t+"")))return!1;var u=n.constructor,s=t.constructor;if(u!=s&&!(S(u)&&u instanceof u&&S(s)&&s instanceof s))return!1}e||(e=[]),r||(r=[]);for(var a=e.length;a--;)if(e[a]==n)return r[a]==t;var c=-1,f=!0,l=0;if(e.push(n),r.push(t),o){if(l=n.length,f=l==t.length)for(;l--&&(f=w(n[l],t[l],e,r)););return f}for(var p in n)if(xe.call(n,p)&&(l++,!xe.call(t,p)||!w(n[p],t[p],e,r)))return!1;for(p in t)if(xe.call(t,p)&&!l--)return!1;if(Qt)for(;7>++c;)if(p=_e[c],xe.call(n,p)&&(!xe.call(t,p)||!w(n[p],t[p],e,r)))return!1;return!0}function k(n){return Ee(n)&&!De(parseFloat(n))}function S(n){return"function"==typeof n}function O(n){return n?nr[typeof n]:!1}function A(n){return Se.call(n)==qe&&n!=+n}function E(n){return null===n}function D(n){return Se.call(n)==qe}function L(n){return Se.call(n)==He}function I(n){return Se.call(n)==$e}function B(n){return n===t}function C(n,t,e){var r=arguments,i=0,o=2,u=r[3],s=r[4];for(e!==te&&(u=[],s=[],o=r.length);o>++i;)sr(r[i],function(t,e){var r,i,o;if(t&&((i=hr(t))||pr(t))){for(var a=u.length;a--&&!(r=u[a]==t););r?n[e]=s[a]:(u.push(t),s.push((o=n[e],o=i?hr(o)?o:[]:pr(o)?o:{})),n[e]=C(o,t,te,u,s))}else null!=t&&(n[e]=t)});return n}function T(n,t,e){var r="function"==typeof t,i={};if(r)t=u(t,e);else var o=ye.apply(Yt,arguments);return ur(n,function(n,e,u){(r?!t(n,e,u):0>at(o,e,1))&&(i[e]=n)}),i}function F(n){var t=[];return sr(n,function(n,e){t.push([e,n])}),t}function P(n,t,e){var r={};if("function"!=typeof t)for(var i=0,o=ye.apply(Yt,arguments),s=o.length;s>++i;){var a=o[i];a in n&&(r[a]=n[a])}else t=u(t,e),ur(n,function(n,e,i){t(n,e,i)&&(r[e]=n)});return r}function M(n){var t=[];return sr(n,function(n){t.push(n)}),t}function R(n,t){var e=n?n.length:0;return"number"==typeof e?(Se.call(n)==$e?n.indexOf(t):at(n,t))>-1:nt(n,function(n){return n===t})}function q(n,t,e){var r={};return t=u(t,e),_r(n,function(n,e,i){e=t(n,e,i),xe.call(r,e)?r[e]++:r[e]=1}),r}function N(n,t,e){var r=!0;return t=u(t,e),_r(n,function(n,e,i){return r=!!t(n,e,i)}),r}function H(n,t,e){var r=[];return t=u(t,e),_r(n,function(n,e,i){t(n,e,i)&&r.push(n)}),r}function $(n,t,e){var r;return t=u(t,e),nt(n,function(n,e,i){return t(n,e,i)&&(r=n,!0)}),r}function K(n,t,e){var r={};return t=u(t,e),_r(n,function(n,e,i){e=t(n,e,i),(xe.call(r,e)?r[e]:r[e]=[]).push(n)}),r}function W(n,t){var e=ke.call(arguments,2),r="function"==typeof t,i=[];return _r(n,function(n){i.push((r?t:n[t]).apply(n,e))}),i}function U(n,t,e){var r=-1,i=n?n.length:0,o=Array("number"==typeof i?i:0);if(t=u(t,e),hr(n))for(;i>++r;)o[r]=t(n[r],r,n);else _r(n,function(n,e,i){o[++r]=t(n,e,i)});return o}function z(n,t,e){var r=-1/0,i=-1,o=n?n.length:0,s=r;if(t||"number"!=typeof o)t=u(t,e),_r(n,function(n,e,i){var o=t(n,e,i);o>r&&(r=o,s=n)});else for(;o>++i;)n[i]>s&&(s=n[i]);return s}function V(n,t,e){var r=1/0,i=-1,o=n?n.length:0,s=r;if(t||"number"!=typeof o)t=u(t,e),_r(n,function(n,e,i){var o=t(n,e,i);r>o&&(r=o,s=n)});else for(;o>++i;)s>n[i]&&(s=n[i]);return s}function G(n,t){var e=[];return _r(n,function(n){e.push(n[t])}),e}function J(n,t,e,r){var i=3>arguments.length;return t=u(t,r),_r(n,function(n,r,o){e=i?(i=!1,n):t(e,n,r,o)}),e}function Q(n,t,e,r){var i=n,o=n?n.length:0,u=3>arguments.length;if("number"!=typeof o){var s=vr(n);o=s.length}else Ve&&Se.call(n)==$e&&(i=n.split(""));return _r(n,function(n,a,c){a=s?s[--o]:--o,e=u?(u=!1,i[a]):t.call(r,e,i[a],a,c)}),e}function X(n,t,e){return t=u(t,e),H(n,function(n,e,r){return!t(n,e,r)})}function Y(n){var t=-1,e=Array(n?n.length:0);return _r(n,function(n){var r=me(Ce()*(++t+1));e[t]=e[r],e[r]=n}),e}function Z(n){var t=n?n.length:0;return"number"==typeof t?t:vr(n).length}function nt(n,t,e){var r;return t=u(t,e),_r(n,function(n,e,i){return!(r=t(n,e,i))}),!!r}function tt(n,t,e){var r=[];t=u(t,e),_r(n,function(n,e,i){r.push({criteria:t(n,e,i),index:e,value:n})});var o=r.length;for(r.sort(i);o--;)r[o]=r[o].value;return r}function et(n){return n&&"number"==typeof n.length?(ze?Se.call(n)==$e:"string"==typeof n)?n.split(""):ke.call(n):M(n)}function rt(n,t){var e=[];return ur(t,function(n,t){e.push(t)}),H(n,function(n){for(var r=e.length;r--;){var i=n[e[r]]===t[e[r]];if(!i)break}return!!i})}function it(n){for(var t=-1,e=n?n.length:0,r=[];e>++t;){var i=n[t];i&&r.push(i)}return r}function ot(n){for(var t=-1,e=n?n.length:0,i=ye.apply(Yt,arguments),o=r(i,e),u=[];e>++t;){var s=n[t];o(s)||u.push(s)}return u}function ut(n,e,r){return n?null==e||r?n[0]:ke.call(n,0,e):t}function st(n,t){for(var e=-1,r=n?n.length:0,i=[];r>++e;){var o=n[e];hr(o)?je.apply(i,t?o:st(o)):i.push(o)}return i}function at(n,t,e){var r=-1,i=n?n.length:0;if("number"==typeof e)r=(0>e?Ie(0,i+e):e||0)-1;else if(e)return r=gt(n,t),n[r]===t?r:-1;for(;i>++r;)if(n[r]===t)return r;return-1}function ct(n,t,e){return n?ke.call(n,0,-(null==t||e?1:t)):[]}function ft(n){var t=arguments,e=t.length,i={},o=[];return _r(n,function(n){if(0>at(o,n)){for(var u=e;--u;)if(!(i[u]||(i[u]=r(t[u])))(n))return;o.push(n)}}),o}function lt(n,t,e){if(n){var r=n.length;return null==t||e?n[r-1]:ke.call(n,-t||r)}}function ht(n,t,e){var r=n?n.length:0;for("number"==typeof e&&(r=(0>e?Ie(0,r+e):Be(e,r-1))+1);r--;)if(n[r]===t)return r;return-1}function pt(n,t){for(var e=-1,r=n?n.length:0,i={};r>++e;){var o=n[e];t?i[o]=t[e]:i[o[0]]=o[1]}return i}function vt(n,t,e){n=+n||0,e=+e||1,null==t&&(t=n,n=0);for(var r=-1,i=Ie(0,de((t-n)/e)),o=Array(i);i>++r;)o[r]=n,n+=e;return o}function _t(n,t,e){return n?ke.call(n,null==t||e?1:t):[]}function gt(n,t,e,r){var i=0,o=n?n.length:i;for(e=e?u(e,r):Ft,t=e(t);o>i;){var s=i+o>>>1;t>e(n[s])?i=s+1:o=s}return i}function dt(){return yt(ye.apply(Yt,arguments))}function yt(n,t,e,r){var i=-1,o=n?n.length:0,s=[],a=s;for("function"==typeof t&&(r=e,e=t,t=!1),e&&(a=[],e=u(e,r));o>++i;){var c=n[i],f=e?e(c,i,n):c;(t?!i||a[a.length-1]!==f:0>at(a,f))&&(e&&a.push(f),s.push(c))}return s}function mt(n){for(var t=-1,e=n?n.length:0,i=r(arguments,1,20),o=[];e>++t;){var u=n[t];i(u)||o.push(u)}return o}function bt(n){for(var t=-1,e=n?z(G(arguments,"length")):0,r=Array(e);e>++t;)r[t]=G(arguments,t);return r}function xt(n,e){return 1>n?e():function(){return 1>--n?e.apply(this,arguments):t}}function jt(n,t){return Qe||Oe&&arguments.length>2?Oe.call.apply(Oe,arguments):o(n,t,ke.call(arguments,2))}function wt(n){for(var t=arguments,e=t.length>1?0:(t=g(n),-1),r=t.length;r>++e;){var i=t[e];n[i]=jt(n[i],n)}return n}function kt(){var n=arguments;return function(){for(var t=arguments,e=n.length;e--;)t=[n[e].apply(this,t)];return t[0]}}function St(n,t,e){function r(){s=null,e||(o=n.apply(u,i))}var i,o,u,s;return function(){var a=e&&!s;return i=arguments,u=this,clearTimeout(s),s=setTimeout(r,t),a&&(o=n.apply(u,i)),o}}function Ot(n,e){var r=ke.call(arguments,2);return setTimeout(function(){n.apply(t,r)},e)}function At(n){var e=ke.call(arguments,1);return setTimeout(function(){n.apply(t,e)},1)}function Et(n,t){return o(t,n,ke.call(arguments,2))}function Dt(n,t){var e={};return function(){var r=t?t.apply(this,arguments):arguments[0];return xe.call(e,r)?e[r]:e[r]=n.apply(this,arguments)}}function Lt(n){var t,e=!1;return function(){return e?t:(e=!0,t=n.apply(this,arguments),n=null,t)}}function It(n){return o(n,ke.call(arguments,1))}function Bt(n,t){function e(){s=new Date,u=null,i=n.apply(o,r)}var r,i,o,u,s=0;return function(){var a=new Date,c=t-(a-s);return r=arguments,o=this,0>=c?(clearTimeout(u),s=a,i=n.apply(o,r)):u||(u=setTimeout(e,c)),i}}function Ct(n,t){return function(){var e=[n];return je.apply(e,arguments),t.apply(this,e)}}function Tt(n){return null==n?"":(n+"").replace(pe,c)}function Ft(n){return n}function Pt(n){_r(g(n),function(t){var r=e[t]=n[t];e.prototype[t]=function(){var n=[this.__wrapped__];je.apply(n,arguments);var t=r.apply(e,n);return this.__chain__&&(t=new e(t),t.__chain__=!0),t}})}function Mt(){return n._=re,this}function Rt(n,t){return null==n&&null==t&&(t=1),n=+n||0,null==t&&(t=n,n=0),n+me(Ce()*((+t||0)-n+1))}function qt(n,t){var e=n?n[t]:null;return S(e)?n[t]():e}function Nt(n,t,r){n||(n=""),r||(r={});var i,o,u=0,s=e.templateSettings,c="__p += '",f=r.variable||s.variable,l=f,h=RegExp((r.escape||s.escape||he).source+"|"+(r.interpolate||s.interpolate||he).source+"|"+(r.evaluate||s.evaluate||he).source+"|$","g");if(n.replace(h,function(t,e,r,o,s){c+=n.slice(u,s).replace(ve,a),c+=e?"' +\n__e("+e+") +\n'":o?"';\n"+o+";\n__p += '":r?"' +\n((__t = ("+r+")) == null ? '' : __t) +\n'":"",i||(i=o||ie.test(e||r)),u=s+t.length}),c+="';\n",!l)if(f="obj",i)c="with ("+f+") {\n"+c+"\n}\n";else{var p=RegExp("(\\(\\s*)"+f+"\\."+f+"\\b","g");c=c.replace(fe,"$&"+f+".").replace(p,"$1__d")}c=(i?c.replace(ue,""):c).replace(se,"$1").replace(ae,"$1;"),c="function("+f+") {\n"+(l?"":f+" || ("+f+" = {});\n")+"var __t, __p = '', __e = _.escape"+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(l?"":", __d = "+f+"."+f+" || "+f)+";\n")+c+"return __p\n}";var v=Ye?"\n//@ sourceURL="+(r.sourceURL||"/lodash/template/source["+ge++ +"]"):"";try{o=Function("_","return "+c+v)(e)}catch(_){throw _.source=c,_}return t?o(t):(o.source=c,o)}function Ht(n,t,e){n=+n||0;for(var r=-1,i=Array(n);n>++r;)i[r]=t.call(e,r);return i}function $t(n){return null==n?"":(n+"").replace(oe,l)}function Kt(n){var t=ne++;return n?n+t:t}function Wt(n){return n=new e(n),n.__chain__=!0,n}function Ut(n,t){return t(n),n}function zt(){return this.__chain__=!0,this}function Vt(){return this.__wrapped__}var Gt="object"==typeof exports&&exports,Jt="object"==typeof global&&global;Jt.global===Jt&&(n=Jt);var Qt,Xt,Yt=[],Zt={},ne=0,te={},ee=30,re=n._,ie=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,oe=/&(?:amp|lt|gt|quot|#x27);/g,ue=/\b__p \+= '';/g,se=/\b(__p \+=) '' \+/g,ae=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ce=/\w*$/,fe=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,le=RegExp("^"+(Zt.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),he=/($^)/,pe=/[&<>"']/g,ve=/['\n\r\t\u2028\u2029\\]/g,_e=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ge=0,de=Math.ceil,ye=Yt.concat,me=Math.floor,be=le.test(be=Object.getPrototypeOf)&&be,xe=Zt.hasOwnProperty,je=Yt.push,we=Zt.propertyIsEnumerable,ke=Yt.slice,Se=Zt.toString,Oe=le.test(Oe=ke.bind)&&Oe,Ae=le.test(Ae=Array.isArray)&&Ae,Ee=n.isFinite,De=n.isNaN,Le=le.test(Le=Object.keys)&&Le,Ie=Math.max,Be=Math.min,Ce=Math.random,Te="[object Arguments]",Fe="[object Array]",Pe="[object Boolean]",Me="[object Date]",Re="[object Function]",qe="[object Number]",Ne="[object Object]",He="[object RegExp]",$e="[object String]",Ke=(Ke={0:1,length:1},Yt.splice.call(Ke,0,1),Ke[0]),We=!0;(function(){function n(){this.x=1}var t=[];n.prototype={valueOf:1,y:1};for(var e in new n)t.push(e);for(e in arguments)We=!e;Qt=!/valueOf/.test(t),Xt="x"!=t[0]})(1);var Ue=!h(arguments),ze="x"!=ke.call("x")[0],Ve="xx"!="x"[0]+Object("x")[0];try{var Ge=Se.call(n.document||0)==Ne}catch(Je){}var Qe=Oe&&/\n|Opera/.test(Oe+Se.call(n.opera)),Xe=Le&&/^.+$|true/.test(Le+!!n.attachEvent);try{var Ye=(Function("//@")(),!n.attachEvent)}catch(Je){}var Ze={};Ze[Te]=Ze[Re]=!1,Ze[Fe]=Ze[Pe]=Ze[Me]=Ze[qe]=Ze[Ne]=Ze[He]=Ze[$e]=!0;var nr={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},tr={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};e.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""};var er=Nt("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (toString.call(iteratee) == stringClass) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),rr={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},ir={useHas:!1,args:"object",top:"for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n  if (iteratee = arguments[argsIndex]) {",objectLoop:"result[index] = value",bottom:"  }\n}"},or={arrayLoop:null};Ue&&(h=function(n){return n?xe.call(n,"callee"):!1});var ur=s(rr,or,{useHas:!1}),sr=s(rr,or),ar={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},cr=y(ar),fr=s(ir,{objectLoop:"if (result[index] == null) "+ir.objectLoop}),lr=s(ir),hr=Ae||function(n){return Se.call(n)==Fe};S(/x/)&&(S=function(n){return Se.call(n)==Re});var pr=be?function(n){if(!n||"object"!=typeof n)return!1;var t=n.valueOf,e="function"==typeof t&&(e=be(t))&&be(e);return e?n==e||be(n)==e&&!h(n):p(n)}:p,vr=Le?function(n){var t=typeof n;return"function"==t&&we.call(n,"prototype")?v(n):n&&nr[t]?Le(n):[]}:v,_r=s(rr);e.VERSION="0.9.1",e.after=xt,e.bind=jt,e.bindAll=wt,e.chain=Wt,e.clone=_,e.compact=it,e.compose=kt,e.contains=R,e.countBy=q,e.debounce=St,e.defaults=fr,e.defer=At,e.delay=Ot,e.difference=ot,e.escape=Tt,e.every=N,e.extend=lr,e.filter=H,e.find=$,e.first=ut,e.flatten=st,e.forEach=_r,e.forIn=ur,e.forOwn=sr,e.functions=g,e.groupBy=K,e.has=d,e.identity=Ft,e.indexOf=at,e.initial=ct,e.intersection=ft,e.invert=y,e.invoke=W,e.isArguments=h,e.isArray=hr,e.isBoolean=m,e.isDate=b,e.isElement=x,e.isEmpty=j,e.isEqual=w,e.isFinite=k,e.isFunction=S,e.isNaN=A,e.isNull=E,e.isNumber=D,e.isObject=O,e.isPlainObject=pr,e.isRegExp=L,e.isString=I,e.isUndefined=B,e.keys=vr,e.last=lt,e.lastIndexOf=ht,e.lateBind=Et,e.map=U,e.max=z,e.memoize=Dt,e.merge=C,e.min=V,e.mixin=Pt,e.noConflict=Mt,e.object=pt,e.omit=T,e.once=Lt,e.pairs=F,e.partial=It,e.pick=P,e.pluck=G,e.random=Rt,e.range=vt,e.reduce=J,e.reduceRight=Q,e.reject=X,e.rest=_t,e.result=qt,e.shuffle=Y,e.size=Z,e.some=nt,e.sortBy=tt,e.sortedIndex=gt,e.tap=Ut,e.template=Nt,e.throttle=Bt,e.times=Ht,e.toArray=et,e.unescape=$t,e.union=dt,e.uniq=yt,e.uniqueId=Kt,e.values=M,e.where=rt,e.without=mt,e.wrap=Ct,e.zip=bt,e.all=N,e.any=nt,e.collect=U,e.detect=$,e.drop=_t,e.each=_r,e.foldl=J,e.foldr=Q,e.head=ut,e.include=R,e.inject=J,e.methods=g,e.select=H,e.tail=_t,e.take=ut,e.unique=yt,e._iteratorTemplate=er,Pt(e),e.prototype.chain=zt,e.prototype.value=Vt,_r(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=Yt[n];e.prototype[n]=function(){var n=this.__wrapped__;return t.apply(n,arguments),Ke&&0===n.length&&delete n[0],this.__chain__&&(n=new e(n),n.__chain__=!0),n}}),_r(["concat","join","slice"],function(n){var t=Yt[n];e.prototype[n]=function(){var n=this.__wrapped__,r=t.apply(n,arguments);return this.__chain__&&(r=new e(r),r.__chain__=!0),r}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(n._=e,define(function(){return e})):Gt?"object"==typeof module&&module&&module.exports==Gt?(module.exports=e)._=e:Gt._=e:n._=e})(this),function(n){function t(n){var t=d[n]={};return f(n.split(/\s+/),function(n){t[n]=!0}),t}var e={},r=Array.prototype,i=Object.prototype,o=i.hasOwnProperty,u=i.toString,s=r.forEach,a=r.indexOf,c=r.slice,f=function(n,t,r){var i,u,a;if(n)if(s&&n.forEach===s)n.forEach(t,r);else if(n.length===+n.length){for(u=0,a=n.length;a>u;u++)if(u in n&&t.call(r,n[u],u,n)===e)return}else for(i in n)if(o.call(n,i)&&t.call(r,n[i],i,n)===e)return},l=function(n){return!!(n&&n.constructor&&n.call&&n.apply)},h=function(n){return f(c.call(arguments,1),function(t){var e;for(e in t)void 0!==t[e]&&(n[e]=t[e])}),n},p=function(n,t,e){var r;if(t){if(a)return a.call(t,n,e);for(r=t.length,e=e?0>e?Math.max(0,r+e):e:0;r>e;e++)if(e in t&&t[e]===n)return e}return-1},v={};f("Boolean Number String Function Array Date RegExp Object".split(" "),function(n){v["[object "+n+"]"]=n.toLowerCase()});var _=function(n){return null==n?n+"":v[u.call(n)]||"object"},g={},d={};g.Callbacks=function(n){n="string"==typeof n?d[n]||t(n):h({},n);var e,r,i,o,u,s,a=[],c=!n.once&&[],l=function(t){for(e=n.memory&&t,r=!0,s=o||0,o=0,u=a.length,i=!0;a&&u>s;s++)if(a[s].apply(t[0],t[1])===!1&&n.stopOnFalse){e=!1;break}i=!1,a&&(c?c.length&&l(c.shift()):e?a=[]:v.disable())},v={add:function(){if(a){var t=a.length;(function r(t){f(t,function(t){var e=_(t);"function"!==e||n.unique&&v.has(t)?t&&t.length&&"string"!==e&&r(t):a.push(t)})})(arguments),i?u=a.length:e&&(o=t,l(e))}return this},remove:function(){return a&&f(arguments,function(n){for(var t;(t=p(n,a,t))>-1;)a.splice(t,1),i&&(u>=t&&u--,s>=t&&s--)}),this},has:function(n){return p(n,a)>-1},empty:function(){return a=[],this},disable:function(){return a=c=e=void 0,this},disabled:function(){return!a},lock:function(){return c=void 0,e||v.disable(),this},locked:function(){return!c},fireWith:function(n,t){return t=t||[],t=[n,t.slice?t.slice():t],!a||r&&!c||(i?c.push(t):l(t)),this},fire:function(){return v.fireWith(this,arguments),this},fired:function(){return!!r}};return v},g.Deferred=function(n){var t=[["resolve","done",g.Callbacks("once memory"),"resolved"],["reject","fail",g.Callbacks("once memory"),"rejected"],["notify","progress",g.Callbacks("memory")]],e="pending",r={state:function(){return e},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var n=arguments;return g.Deferred(function(e){f(t,function(t,r){var o=t[0],u=n[r];i[t[1]](l(u)?function(){var n=u.apply(this,arguments);n&&l(n.promise)?n.promise().done(e.resolve).fail(e.reject).progress(e.notify):e[o+"With"](this===i?e:this,[n])}:e[o])}),n=null}).promise()},promise:function(n){return"object"==typeof n?h(n,r):r}},i={};return r.pipe=r.then,f(t,function(n,o){var u=n[2],s=n[3];r[n[1]]=u.add,s&&u.add(function(){e=s},t[1^o][2].disable,t[2][2].lock),i[n[0]]=u.fire,i[n[0]+"With"]=u.fireWith}),r.promise(i),n&&n.call(i,i),i},g.when=function(n){var t,e,r,i=0,o=c.call(arguments),u=o.length,s=1!==u||n&&l(n.promise)?u:0,a=1===s?n:g.Deferred(),f=function(n,e,r){return function(i){e[n]=this,r[n]=arguments.length>1?c.call(arguments):i,r===t?a.notifyWith(e,r):--s||a.resolveWith(e,r)}};if(u>1)for(t=Array(u),e=Array(u),r=Array(u);u>i;i++)o[i]&&l(o[i].promise)?o[i].promise().done(f(i,r,o)).fail(a.reject).progress(f(i,e,t)):--s;return s||a.resolveWith(r,o),a.promise()},"undefined"!=typeof module&&module.exports?module.exports=g:n._!==void 0?n._.mixin(g):n._=g}(this),function(n,_){var t=n.Miso=n.Miso||{};t.Events={publish:function(n){var t=_.toArray(arguments);return t.shift(),this._events&&this._events[n]&&_.each(this._events[n],function(n){n.callback.apply(n.context||this,t)},this),this},subscribe:function(n,t,e){e=e||{},this._events=this._events||{},this._events[n]=this._events[n]||[];var r,i={callback:t,priority:e.priority||0,token:e.token||_.uniqueId("t"),context:e.context||this};return _.each(this._events[n],function(n,t){_.isUndefined(r)&&n.priority<=i.priority&&(r=t)}),this._events[n].splice(r,0,i),i.token},subscribeOnce:function(n,t){this._events=this._events||{};var e=_.uniqueId("t");return this.subscribe(n,function(){this.unsubscribe(n,{token:e}),t.apply(this,arguments)},this,e)},unsubscribe:function(n,t){return _.isUndefined(this._events[n])?this:(this._events[n]=_.isFunction(t)?_.reject(this._events[n],function(n){return n.callback===t}):_.isString(t)?_.reject(this._events[n],function(n){return n.token===t}):[],this)}}}(this,_),function(n,_){function t(n,t,e){this._transitioning=!0;var r=this._complete=e||_.Deferred(),i=t?t:[],o=_.Deferred().done(_.bind(function(){this._transitioning=!1,this._current=n,r.resolve()},this)).fail(_.bind(function(){this._transitioning=!1,r.reject()},this));return this.handlers[n].call(this._context,i,o),r.promise()}function e(n,t,e){var r=this.scenes[n],i=this._current,o=t?t:[],u=this._complete=e||_.Deferred(),s=_.Deferred(),a=_.Deferred(),c=_.bind(function(n,t){var e=t?i:r;e=e?e.name:"",this.publish(n,i,r),("start"!==n||"end"!==n)&&this.publish(e+":"+n)},this),f=_.bind(function(){this._transitioning=!1,this._current=i,c("fail"),u.reject()},this),l=_.bind(function(){c("enter"),this._transitioning=!1,this._current=r,c("end"),u.resolve()},this);if(!r)throw"Scene '"+n+"' not found!";return this._transitioning?u.reject():(c("start"),this._transitioning=!0,i?(i.to("exit",o,s),s.done(function(){c("exit",!0)})):s.resolve(),_.when(s).then(function(){r.to("enter",o,a)}).fail(f),a.then(l).fail(f),u.promise())}function r(n,t){if(!_.isFunction(n))return n;if(/^_/.test(t))return n;if(n.__wrapped)return n;var e=function(t,e){var r,i=!1;return e=e||_.Deferred(),this.async=function(){return i=!0,function(n){return n!==!1?e.resolve():e.reject()}},r=n.apply(this,t),this.async=void 0,i?e.promise():r!==!1?e.resolve():e.reject()};return e.__wrapped=!0,e}var i=n.Miso=n.Miso||{},o=i.Storyboard=function(n){n=n||{},this._originalOptions=n,this._context=n.context||this,this._id=_.uniqueId("scene"),n.scenes?(this._buildScenes(n.scenes),this._initial=n.initial,this.to=e):(this.handlers={},_.each(o.HANDLERS,function(t){n[t]=n[t]||function(){return!0},this.handlers[t]=r(n[t],t)},this),this.to=t),_.each(n,function(n,t){-1===_.indexOf(o.BLACKLIST,t)&&(this[t]=_.isFunction(n)?function(t){return function(){n.apply(t._context||t,arguments)}}(this):n)},this)};o.HANDLERS=["enter","exit"],o.BLACKLIST=["_id","initial","scenes","enter","exit","context","_current"],_.extend(o.prototype,i.Events,{clone:function(){return this.scenes&&_.each(this._originalOptions.scenes,function(n,t){n instanceof i.Storyboard&&(this._originalOptions.scenes[t]=n.clone())},this),new i.Storyboard(this._originalOptions)},attach:function(n,t){return this.name=n,this.parent=t,t._context&&t._context._id!==t._id&&(this._context=t._context,this.scenes&&_.each(this.scenes,function(n){n.attach(n.name,this)},this)),this},start:function(){return this._current!==void 0?_.Deferred().resolve():this.to(this._initial)},cancelTransition:function(){this._complete.reject(),this._transitioning=!1},scene:function(){return this._current?this._current.name:null},is:function(n){return n===this._current.name},inTransition:function(){return this._transitioning===!0},setContext:function(n){this._context=n,this.scenes&&_.each(this.scenes,function(t){t.setContext(n)})},_buildScenes:function(n){this.scenes={},_.each(n,function(n,t){this.scenes[t]=n instanceof i.Storyboard?n:new i.Storyboard(n),this.scenes[t].attach(t,this)},this)}})}(this,_);